{"version":3,"sources":["components/Dashboard/ZuluTime.js","components/Dashboard/AirportRow.js","components/Dashboard/AirportWarning.js","components/Dashboard/Airport.js","components/Dashboard/AirportRows.js","components/Dashboard/MetarAge.js","components/Dashboard/AirportInfo.js","components/Dashboard.js","components/Logs.js","components/Tools.js","lib/WebSocketClient.js","App.js","index.js"],"names":["ZuluTime","className","style","marginTop","paddingTop","this","props","current_time","toUTCString","React","Component","AirportRow","children","AirportWarning","warning","key","Date","now","metar","wind_speed_kt","_text","push","wind_gust_kt","id","station_id","Airport","sendAirportData","updateSelectedAirport","onClick","flight_category","padding","marginBottom","AirportRows","flightCategory","items","metars","length","forEach","_i","airport","Object","values","flightCategoryCSS","flightCategoryToCSS","rawText","raw_text","item","rows","i","airportRows","start","airportsPerRow","end","slice","map","row","MetarAge","metarAgeTime","diff","Math","floor","last_updated","toString","padStart","AirportInfo","metar_text","taf_text","selectedAirport","airport_id","taf","airports","split","join","Dashboard","cycleDelay","afterClickCycleDelay","clearTimeout","state","airportCycleTimer","setTimeout","cycleAirports","setState","nextIndex","currentIndex","componentWillUnmount","airportComponents","currentTime","setInterval","metarCount","lastUpdated","Logs","componentDidMount","console","log","logLines","Tools","setLedState","ws","send","leds","ledState","ledStateString","ledStateCssClass","updateData","data","WebSocketClient","App","connectAndSubscribe","connect","registerCallbacks","subscribe","window","location","host","WebSocket","onopen","messageTypes","messageType","onmessage","evt","handleMessage","JSON","parse","onerror","onclose","attemptReconnect","reconnectTimeout","message","stringify","type","payload","activeTab","isActive","tabName","makeActive","render","to","exact","path","ReactDOM","document","getElementById"],"mappings":"4RAGqBA,E,iLAEjB,OACE,yBAAKC,UAAU,qBACb,yBAAKA,UAAU,uBAAuBC,MAAO,CAAEC,UAAW,MAAOC,WAAY,QAC3E,yBAAKH,UAAU,iBACb,yBAAKA,UAAU,+BAA+BI,KAAKC,MAAMC,aAAaC,sB,GAN5CC,IAAMC,WCAvBC,E,iLAEjB,OACE,yBAAKV,UAAU,oBACZI,KAAKC,MAAMM,c,GAJoBH,IAAMC,WCAzBG,E,iLAEjB,IAAIC,EAAU,GACVC,EAAMC,KAAKC,MAOf,OAJGZ,KAAKC,MAAMY,MAAMC,eAAiBd,KAAKC,MAAMY,MAAMC,cAAcC,MAAQ,IAAKN,EAAQO,KAAK,uBAAGN,IAAKA,EAAKd,UAAU,iCAClHI,KAAKC,MAAMY,MAAMI,cAAgBjB,KAAKC,MAAMY,MAAMI,aAAaF,MAAQ,IAAKN,EAAQO,KAAK,uBAAGN,IAAKA,EAAM,EAAGd,UAAU,iCACpHI,KAAKC,MAAMY,MAAMI,cAAgBjB,KAAKC,MAAMY,MAAMI,aAAaF,MAAQ,IAAKN,EAAQO,KAAK,uBAAGN,IAAKA,EAAM,EAAGd,UAAU,iCAGrH,uBAAGsB,GAAIlB,KAAKC,MAAMY,MAAMM,WAAYvB,UAAU,kCAC1Ca,O,GAZkCL,IAAMC,WCE7Be,E,2MACnBC,gBAAkB,WAChB,EAAKpB,MAAMqB,sBAAsB,EAAKrB,MAAMY,Q,wEAI5C,OACE,yBAAKjB,UAAU,mCAAmC2B,QAASvB,KAAKqB,iBAC9D,6BAASzB,UAAS,yCAAqCI,KAAKC,MAAMuB,iBAAoB3B,MAAO,CAAC4B,QAAS,gBACrG,uBAAG7B,UAAU,+BAA+BC,MAAO,CAAC6B,aAAc,QAAlE,IAA4E1B,KAAKC,MAAMiB,GAAvF,KACA,kBAAC,EAAD,CAAgBL,MAAOb,KAAKC,MAAMY,c,GAVPT,IAAMC,WCAtBsB,E,4LAECC,GAClB,MAAsB,QAAnBA,EACM,aACoB,SAAnBA,EACD,UACoB,QAAnBA,EACD,YACoB,SAAnBA,EACD,UAEA,WAAaA,I,+BAIf,IAAD,OACFC,EAAQ,GACZ,GAAgC,IAA7B7B,KAAKC,MAAM6B,OAAOC,OAAe,OAAO,EAC3C/B,KAAKC,MAAM6B,OAAOE,SAAQ,SAACnB,EAAOoB,GAChC,GAAIpB,EAAJ,CACA,IAAIqB,EAAUC,OAAOC,OAAOvB,EAAMM,YAC9BkB,EAAoBxB,EAAMW,gBAAkB,EAAKc,oBAAoBzB,EAAMW,gBAAgBT,OAAS,mBACpGwB,EAAUJ,OAAOC,OAAOvB,EAAM2B,UAE9BC,EAAO,kBAAC,EAAD,CACG/B,IAAKwB,EACLhB,GAAIgB,EACJV,gBAAiBa,EACjBG,SAAUD,EACVjB,sBAAuB,EAAKrB,MAAMqB,sBAClCT,MAAOA,IAGrBgB,EAAMb,KAAKyB,OAIb,IADA,IAAIC,EAAO,GACHC,EAAI,EAAGA,EAAI3C,KAAKC,MAAM2C,YAAaD,IAAI,CAC7C,IAAIE,EAAQF,EAAI3C,KAAKC,MAAM6C,eACvBC,EAAMF,EAAQ7C,KAAKC,MAAM6C,eAC7BJ,EAAK1B,KAAKa,EAAMmB,MAAMH,EAAOE,IAE/B,OAAOL,EAAKO,KAAI,SAACC,EAAKP,GAAQ,OAAO,kBAAC,EAAD,CAAYjC,IAAKiC,GAAIO,U,GA3CrB9C,IAAMC,WCF1B8C,E,2MACnBC,aAAe,WACb,IAAIC,EAAOC,KAAKC,OAAO,EAAKtD,MAAMC,aAAe,EAAKD,MAAMuD,cAAgB,KAG5E,OAFUF,KAAKC,MAAMF,EAAO,IAEf,IADHC,KAAKC,MAAMF,EAAO,IACLI,WAAWC,SAAS,EAAG,M,wEAI9C,OACE,yBAAK9D,UAAU,qBACb,yBAAKA,UAAU,6CAA6CC,MAAO,CAAEC,UAAW,MAAOC,WAAY,QACjG,yBAAKH,UAAU,iBACb,yBAAKA,UAAU,mBAAmBI,KAAKoD,eAAvC,e,GAb0BhD,IAAMC,WCAvBsD,E,iLAEjB,IAAIC,EAAa,KACbC,EAAW,GACf,GAAG7D,KAAKC,MAAM6D,gBAAgB,CAC5B,IAAIC,EAAa/D,KAAKC,MAAM6D,gBAAgB3C,WAAWJ,MAEvD6C,EAAa5D,KAAKC,MAAM6D,gBAAgBtB,SAASzB,MACjD,IAAIiD,EAAMhE,KAAKC,MAAMgE,SAASF,GAAYC,IACvCA,IACDH,EAAWG,EAAIxB,SAASzB,MAAMmD,MAAM,iCAGtCN,EAAa,GAGf,OACE,yBAAKhE,UAAU,qBACb,6BACE,2BAAIgE,GACJ,2BAAIC,EAASM,KAAK,a,GApBa/D,IAAMC,WCI1B+D,E,YAKnB,WAAYnE,GAAO,IAAD,8BAChB,4CAAMA,KALR6C,eAAiB,EAIC,EAHlBuB,WAAa,IAGK,EAFlBC,qBAAuB,IAEL,EAYlBhD,sBAAwB,SAACT,GACvB0D,aAAa,EAAKC,MAAMC,mBACxB,IAAIA,EAAoBC,WAAW,EAAKC,cAAe,EAAKL,sBAC5D,EAAKM,SAAS,CACZH,kBAAmBA,EACnBX,gBAAiBjD,KAjBH,EAsBlB8D,cAAgB,WACd,IAAI,EAAKH,MAAMV,kBACT,EAAK7D,MAAM6B,OAIb,OADA4C,WAAW,EAAKC,cAAe,MACxB,EAIX,IAAIE,EAAY,EAAKL,MAAMM,cAAiB,EAAK7E,MAAM6B,OAAOC,OAAS,EAAK,EAAI,EAAKyC,MAAMM,aAAe,EAC1G,EAAKF,SAAS,CAAEE,aAAcD,IAE9B,IAAIJ,EAAoBC,WAAW,EAAKC,cAAe,EAAKN,YAC5D,EAAKO,SAAS,CACZH,kBAAmBA,EACnBX,gBAAiB,EAAK7D,MAAM6B,OAAO,EAAK0C,MAAMM,iBAtChC,EAgDlBC,qBAAuB,aA9CrB,EAAKP,MAAQ,CACXV,gBAAiB,KACjBkB,kBAAmB,GACnBF,aAAc,EACdL,kBAAmB,KACnBQ,YAAa,IAAItE,MAPH,E,iFA0CG,IAAD,OAClBuE,aAAY,WAAQ,EAAKN,SAAS,CAAEK,YAAc,IAAItE,SAAa,KACnEX,KAAK2E,kB,+BAQL,OACE,6BACE,kBAAC,EAAD,CAAUzE,aAAcF,KAAKwE,MAAMS,cACnC,kBAAC,EAAD,CAAanD,OAAQ9B,KAAKC,MAAM6B,OAAQc,YAAa5C,KAAKC,MAAMkF,WAAanF,KAAK8C,eAAgBA,eAAgB9C,KAAK8C,eAAgBxB,sBAAuBtB,KAAKsB,wBACnK,kBAAC,EAAD,CAAUpB,aAAcF,KAAKwE,MAAMS,YAAazB,aAAc,IAAI7C,KAAKX,KAAKC,MAAMmF,eAElF,kBAAC,EAAD,CAAatB,gBAAiB9D,KAAKwE,MAAMV,gBAAiBG,SAAUjE,KAAKC,MAAMgE,gB,GA/DhD7D,IAAMC,WCLxBgF,E,2MACnBC,kBAAoB,WAClBC,QAAQC,IAAI,kB,wEAIZ,OACE,6BACE,6BAAMxF,KAAKC,MAAMwF,SAASrD,a,GARAhC,IAAMC,WCAnBqF,E,YACnB,WAAYzF,GAAO,IAAD,8BAChB,4CAAMA,KAMR0F,YAAc,WACZ,EAAK1F,MAAM2F,GAAGC,KAAK,CAAEC,MAAO,EAAKtB,MAAMuB,WACvC,EAAKnB,SAAS,CAAEmB,UAAW,EAAKvB,MAAMuB,YATtB,EAYlBC,eAAiB,WAAQ,OAAgC,IAAxB,EAAKxB,MAAMuB,SAAoB,MAAQ,MAZtD,EAclBE,iBAAmB,WACjB,IAAIrG,EAAY,mBAEhB,OADAA,IAAqC,IAAxB,EAAK4E,MAAMuB,SAAqB,aAAe,aAhB5C,EAoBlBG,WAAa,WACX,EAAKjG,MAAM2F,GAAGC,KAAK,CAAEM,KAAM,YAnB3B,EAAK3B,MAAQ,CACXuB,UAAU,GAHI,E,sEA0BhB,OACE,6BACE,2BAAG,4BAAQnG,UAAWI,KAAKiG,mBAAoB1E,QAASvB,KAAK2F,aAA1D,eAAoF3F,KAAKgG,mBAC5F,2BAAG,4BAAQpG,UAAU,6BAA6B2B,QAASvB,KAAKkG,YAA7D,qB,GA9BwB9F,IAAMC,WCApB+F,EACnB,WAAYC,GAAK,IAAD,gCAQhBC,oBAAsB,WACpB,EAAKC,UACL,EAAKC,oBACL,EAAKC,aAXS,KAchBF,QAAU,WACRhB,QAAQC,IAAI,iBAAmBkB,OAAOC,SAASC,MAC/C,EAAKhB,GAAK,IAAIiB,UAAU,QAAUH,OAAOC,SAASC,KAAO,cAhB3C,KAmBhBH,UAAY,WACV,EAAKb,GAAGkB,OAAS,WAAQ,EAAKC,aAAa/E,SAAQ,SAACgF,GAAkB,EAAKnB,KAAK,CAACY,UAAWO,SApB9E,KAwBhBR,kBAAoB,WAClB,EAAKZ,GAAGqB,UAAY,SAACC,GAAU,EAAKC,cAAcC,KAAKC,MAAMH,EAAIf,QACjE,EAAKP,GAAG0B,QAAU,SAACJ,GAAU3B,QAAQC,IAAI,sBAAuBD,QAAQC,IAAI0B,IAC5E,EAAKtB,GAAG2B,QAAU,SAACL,GAAU3B,QAAQC,IAAI,qBAAsB,EAAKgC,qBA3BtD,KA8BhBA,iBAAmB,WACjBjC,QAAQC,IAAI,mBAAoB,EAAKiC,iBAAkB,QACvD/C,YAAW,WACT,EAAK4B,wBACoB,IAAxB,EAAKmB,mBAlCM,KAqChB5B,KAAO,SAAC6B,GAAc,EAAK9B,GAAGC,KAAKuB,KAAKO,UAAUD,KArClC,KAuChBP,cAAgB,SAACO,GACf,OAAOA,EAAQE,MACb,IAAK,SACHrC,QAAQC,IAAI,YACZ,EAAKa,IAAIzB,SAAS,CAChBX,SAAUyD,EAAQG,QAClB/F,OAAQ4F,EAAQG,QAAQ/F,OAAOmC,SAC/BkB,WAAYuC,EAAQG,QAAQ/F,OAAOmC,SAASlC,OAC5CqD,YAAasC,EAAQG,QAAQ/F,OAAOsD,cAEtC,MACF,IAAK,OACHG,QAAQC,IAAI,UACZ,EAAKa,IAAIzB,SAAS,CAAEa,SAAUiC,EAAQG,UACtC,MACF,QACEtC,QAAQC,IAAI,yBAA2B4B,KAAKO,UAAUD,MAtD1D1H,KAAKyH,iBAAmB,EAExBzH,KAAKqG,IAAMA,EACXrG,KAAK+G,aAAe,CAAC,SAAU,QAC/B/G,KAAKsG,uB,gBC+DMD,E,YAzDb,WAAYpG,GAAO,IAAD,8BAChB,4CAAMA,KAWRqF,kBAAoB,WAClB,IAAIM,EAAK,IAAIQ,EAAJ,gBACT,EAAKxB,SAAS,CACZgB,GAAIA,EACJkC,UAAW,eAhBG,EAoBlBC,SAAW,SAACC,GAAc,GAAGA,IAAY,EAAKxD,MAAMsD,UAAY,MAAO,aApBrD,EAsBlBG,WAAa,SAACD,GAAc,EAAKpD,SAAS,CAACkD,UAAWE,KAtBpC,EAwBlBE,OAAS,WACP,OACE,kBAAC,IAAD,KACE,yBAAKtI,UAAU,QACb,4BACE,wBAAIA,UAAW,EAAKmI,SAAS,cAAc,kBAAC,IAAD,CAAMxG,QAAS,kBAAM,EAAK0G,WAAW,cAAcE,GAAG,KAAtD,cAC3C,wBAAIvI,UAAW,EAAKmI,SAAS,SAAS,kBAAC,IAAD,CAAMxG,QAAS,kBAAM,EAAK0G,WAAW,SAASE,GAAG,SAAjD,SACtC,wBAAIvI,UAAW,EAAKmI,SAAS,UAAU,kBAAC,IAAD,CAAMxG,QAAS,kBAAM,EAAK0G,WAAW,UAAUE,GAAG,UAAlD,YAG3C,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAOC,OAAK,EAACC,KAAK,IAChBH,OAAQ,SAACjI,GAAD,OACN,kBAAC,EAAD,CAAW2F,GAAI,EAAKpB,MAAMoB,GACf3B,SAAU,EAAKO,MAAMP,SACrBnC,OAAQ,EAAK0C,MAAM1C,OACnBqD,WAAY,EAAKX,MAAMW,WACvBC,YAAa,EAAKZ,MAAMY,iBAIvC,kBAAC,IAAD,CAAOiD,KAAK,SACV,kBAAC,EAAD,CAAM5C,SAAU,EAAKjB,MAAMiB,YAE7B,kBAAC,IAAD,CAAO4C,KAAK,UACV,kBAAC,EAAD,CAAOzC,GAAI,EAAKpB,MAAMoB,SA/ChC,EAAKpB,MAAQ,CACXoB,GAAI,KACJ3B,SAAU,GACVnC,OAAQ,GACRqD,WAAY,KACZC,YAAa,KACbK,SAAU,IARI,E,2BADFrF,IAAMC,WCRxBiI,IAASJ,OAAO,kBAAC,EAAD,MAASK,SAASC,eAAe,W","file":"static/js/main.a4e85251.chunk.js","sourcesContent":["import React from 'react';\nimport '../../css/App.css';\n\nexport default class ZuluTime extends React.Component {\n  render(){\n    return(\n      <div className='tile is-ancenstor'>\n        <div className='tile is-parent is-12' style={{ marginTop: '0px', paddingTop: '0px' }} >\n          <div className='tile is-child'>\n            <div className='has-text-centered is-size-4'>{this.props.current_time.toUTCString()}</div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React from 'react';\nimport '../../css/App.css';\n\nexport default class AirportRow extends React.Component {\n  render() {\n    return(\n      <div className=\"tile is-ancestor\">\n        {this.props.children}\n      </div>\n    )\n  }\n}\n","import React from 'react';\nimport '../../css/App.css';\n\nexport default class AirportWarning extends React.Component {\n  render(){\n    let warning = [];\n    let key = Date.now();\n    // We can probably be smarter about displaying warnings\n    // Icing, better represent wind, what else?\n    if(this.props.metar.wind_speed_kt && this.props.metar.wind_speed_kt._text > 20){ warning.push(<i key={key} className=\"fas fa-exclamation-triangle\"></i>) }\n    if(this.props.metar.wind_gust_kt && this.props.metar.wind_gust_kt._text > 20){ warning.push(<i key={key + 1} className=\"fas fa-exclamation-triangle\"></i>) }\n    if(this.props.metar.wind_gust_kt && this.props.metar.wind_gust_kt._text > 30){ warning.push(<i key={key + 2} className=\"fas fa-exclamation-triangle\"></i>) }\n\n    return(\n      <p id={this.props.metar.station_id} className=\"icon is-small has-text-warning\">\n        { warning }\n      </p>\n    )\n  }\n}\n","import React from 'react';\nimport '../../css/App.css';\nimport AirportWarning from './AirportWarning';\n\n// FIXME the box should cursor: pointer\nexport default class Airport extends React.Component {\n  sendAirportData = () => {\n    this.props.updateSelectedAirport(this.props.metar);\n  }\n\n  render() {\n    return(\n      <div className=\"tile is-parent has-text-centered\" onClick={this.sendAirportData}>\n        <article className={ `tile is-child box notification ${this.props.flight_category}` } style={{padding: '0 5px 5px 0'}}>\n          <p className=\"title is-4 has-text-centered\" style={{marginBottom: '5px'}}> {this.props.id} </p>\n          <AirportWarning metar={this.props.metar}/>\n        </article>\n      </div>\n    );\n  }\n}\n\n","import React from 'react';\nimport '../../css/App.css';\nimport AirportRow from './AirportRow';\nimport Airport from './Airport';\n\nexport default class AirportRows extends React.Component{\n  // Convert flight categories to a valid bulma css color class\n  flightCategoryToCSS(flightCategory){\n    if(flightCategory === \"VFR\"){\n      return 'is-success';\n    } else if(flightCategory === 'MVFR'){\n      return 'is-info';\n    } else if(flightCategory === 'IFR'){\n      return 'is-danger';\n    } else if(flightCategory === 'LIFR'){\n      return 'is-lifr';\n    } else {\n      return 'unknown-' + flightCategory;\n    }\n  };\n\n  render(){\n    let items = [];\n    if(this.props.metars.length === 0){ return false }\n    this.props.metars.forEach((metar, _i) => {\n      if(!metar){ return }\n      let airport = Object.values(metar.station_id);\n      let flightCategoryCSS = metar.flight_category ? this.flightCategoryToCSS(metar.flight_category._text) : 'unknown-category';\n      let rawText = Object.values(metar.raw_text);\n\n      let item = <Airport\n                    key={airport}\n                    id={airport}\n                    flight_category={flightCategoryCSS}\n                    raw_text={rawText}\n                    updateSelectedAirport={this.props.updateSelectedAirport}\n                    metar={metar}\n                 />\n\n      items.push(item)\n    });\n\n    let rows = [];\n    for(let i = 0; i < this.props.airportRows; i++){\n      let start = i * this.props.airportsPerRow;\n      let end = start + this.props.airportsPerRow\n      rows.push(items.slice(start, end));\n    }\n    return(rows.map((row, i) => { return(<AirportRow key={i}>{row}</AirportRow>) }))\n  }\n}\n","import React from 'react';\nimport '../../css/App.css';\n\nexport default class MetarAge extends React.Component {\n  metarAgeTime = () => {\n    let diff = Math.floor((this.props.current_time - this.props.last_updated) / 1000);\n    let min = Math.floor(diff / 60);\n    let sec = Math.floor(diff % 60);\n    return min + \":\" + sec.toString().padStart(2, '0');\n  }\n\n  render(){\n    return(\n      <div className='tile is-ancenstor'>\n        <div className='tile is-parent is-12 has-text-grey-lighter' style={{ marginTop: '0px', paddingTop: '0px' }} >\n          <div className='tile is-child'>\n            <div className='is-pulled-right'>{this.metarAgeTime()} old</div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from 'react';\nimport '../../css/App.css';\n\nexport default class AirportInfo extends React.Component {\n  render(){\n    let metar_text = null;\n    let taf_text = [];\n    if(this.props.selectedAirport){\n      let airport_id = this.props.selectedAirport.station_id._text;\n\n      metar_text = this.props.selectedAirport.raw_text._text;\n      let taf = this.props.airports[airport_id].taf\n      if(taf){\n        taf_text = taf.raw_text._text.split(/(?=TEMPO|BECMG|FM|PROB)/)\n      }\n    }else{\n      metar_text = ''\n    }\n\n    return(\n      <div className='has-text-centered'>\n        <pre>\n          <p>{metar_text}</p>\n          <p>{taf_text.join(\"\\n\")}</p>\n        </pre>\n      </div>\n    )\n  }\n}\n","import React from 'react';\nimport '../css/App.css';\nimport ZuluTime from './Dashboard/ZuluTime';\nimport AirportRows from './Dashboard/AirportRows';\nimport MetarAge from './Dashboard/MetarAge';\nimport AirportInfo from './Dashboard/AirportInfo';\n\nexport default class Dashboard extends React.Component {\n  airportsPerRow = 7;\n  cycleDelay = 10 * 1000;\n  afterClickCycleDelay = 20 * 1000;\n\n  constructor(props){\n    super(props);\n    this.state = {\n      selectedAirport: null,\n      airportComponents: [],\n      currentIndex: 0,\n      airportCycleTimer: null,\n      currentTime: new Date()\n    };\n  };\n\n  // When an airport is clicked display the information for that airport\n  updateSelectedAirport = (metar) => {\n    clearTimeout(this.state.airportCycleTimer);\n    let airportCycleTimer = setTimeout(this.cycleAirports, this.afterClickCycleDelay)\n    this.setState({\n      airportCycleTimer: airportCycleTimer,\n      selectedAirport: metar\n    })\n  };\n\n  // FIXME this should show the first airport immediately\n  cycleAirports = () => {\n    if(!this.state.selectedAirport){\n      if(!this.props.metars){\n        // If we dont have any airports loaded keep checking\n        // at a short interval until we do\n        setTimeout(this.cycleAirports, 100);\n        return false\n      }\n    }\n\n    let nextIndex = this.state.currentIndex >= (this.props.metars.length - 1) ? 0 : this.state.currentIndex + 1\n    this.setState({ currentIndex: nextIndex });\n\n    let airportCycleTimer = setTimeout(this.cycleAirports, this.cycleDelay)\n    this.setState({\n      airportCycleTimer: airportCycleTimer,\n      selectedAirport: this.props.metars[this.state.currentIndex]\n    })\n  }\n\n  componentDidMount() {\n    setInterval(() => { this.setState({ currentTime : new Date() }) }, 1000)\n    this.cycleAirports();\n  }\n\n  // FIXME cancel currentTimes timers when unmounting\n  componentWillUnmount = () => {\n  }\n\n  render(){\n    return(\n      <div>\n        <ZuluTime current_time={this.state.currentTime} />\n        <AirportRows metars={this.props.metars} airportRows={this.props.metarCount / this.airportsPerRow} airportsPerRow={this.airportsPerRow} updateSelectedAirport={this.updateSelectedAirport}/>\n        <MetarAge current_time={this.state.currentTime} last_updated={new Date(this.props.lastUpdated)} />\n\n        <AirportInfo selectedAirport={this.state.selectedAirport} airports={this.props.airports}/>\n      </div>\n    );\n  };\n}\n","import React from 'react';\n\nexport default class Logs extends React.Component {\n  componentDidMount = () => {\n    console.log(\"Fetching logs\");\n  }\n\n  render(){\n    return(\n      <div>\n        <pre>{this.props.logLines.values}</pre>\n      </div>\n    );\n  };\n}\n","import React from 'react';\n\nexport default class Tools extends React.Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      ledState: true\n    }\n  }\n\n  setLedState = () => {\n    this.props.ws.send({ leds: !this.state.ledState });\n    this.setState({ ledState: !this.state.ledState });\n  }\n\n  ledStateString = () => { return (this.state.ledState === true ? 'Off' : 'On'); }\n\n  ledStateCssClass = () => {\n    let className = 'button is-large '\n    className += this.state.ledState === false ? 'is-success' : 'is-danger';\n    return className\n  }\n\n  updateData = () => {\n    this.props.ws.send({ data: 'update' });\n  }\n\n\n  render(){\n    return(\n      <div>\n        <p><button className={this.ledStateCssClass()} onClick={this.setLedState}>Turn Lights {this.ledStateString()}</button></p>\n        <p><button className='button is-large is-primary' onClick={this.updateData}>Update Data</button></p>\n      </div>\n    );\n  };\n}\n","// WebSocketClient handles all aspects of our websocket and its data\n// and updates the state of our app\nexport default class WebSocketClient {\n  constructor(App){\n    this.reconnectTimeout = 2;\n\n    this.App = App\n    this.messageTypes = ['metars', 'logs'];\n    this.connectAndSubscribe();\n  };\n\n  connectAndSubscribe = () => {\n    this.connect();\n    this.registerCallbacks();\n    this.subscribe();\n  }\n\n  connect = () => {\n    console.log(\"Opening WS to \" + window.location.host);\n    this.ws = new WebSocket('ws://' + window.location.host + '/metar.ws')\n  }\n\n  subscribe = () => {\n    this.ws.onopen = () => { this.messageTypes.forEach((messageType) => { this.send({subscribe: messageType}) }); }\n\n  }\n\n  registerCallbacks = () => {\n    this.ws.onmessage = (evt) => { this.handleMessage(JSON.parse(evt.data)) }\n    this.ws.onerror = (evt) => { console.log(\"An error occured: \"); console.log(evt) }\n    this.ws.onclose = (evt) => { console.log(\"Connection closed\"); this.attemptReconnect(); }\n  }\n\n  attemptReconnect = () => {\n    console.log(\"Reconnecting in \", this.reconnectTimeout, \" sec\");\n    setTimeout(() => {\n      this.connectAndSubscribe();\n    }, this.reconnectTimeout * 1000)\n  }\n\n  send = (message) => { this.ws.send(JSON.stringify(message)) }\n\n  handleMessage = (message) => {\n    switch(message.type){\n      case \"metars\":\n        console.log('RX METAR');\n        this.App.setState({\n          airports: message.payload,\n          metars: message.payload.metars.airports,\n          metarCount: message.payload.metars.airports.length,\n          lastUpdated: message.payload.metars.lastUpdated\n        });\n        break;\n      case \"logs\":\n        console.log('RX LOG');\n        this.App.setState({ logLines: message.payload, });\n        break;\n      default:\n        console.log('Unknown message type: ' + JSON.stringify(message));\n        break;\n    }\n  }\n}\n","import React from 'react';\nimport './css/App.css';\nimport Dashboard from './components/Dashboard';\nimport Logs from './components/Logs';\nimport Tools from './components/Tools';\nimport WebSocketClient from './lib/WebSocketClient';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\n\nclass App extends React.Component{\n  constructor(props){\n    super(props)\n    this.state = {\n      ws: null,\n      airports: [],\n      metars: [],\n      metarCount: null,\n      lastUpdated: null,\n      logLines: []\n    };\n  }\n\n  componentDidMount = () => {\n    let ws = new WebSocketClient(this);\n    this.setState({\n      ws: ws,\n      activeTab: 'dashboard'\n    })\n  }\n\n  isActive = (tabName) => { if(tabName === this.state.activeTab){ return 'is-active' } }\n\n  makeActive = (tabName) => { this.setState({activeTab: tabName}); }\n\n  render = () => {\n    return(\n      <Router>\n        <div className=\"tabs\">\n          <ul>\n            <li className={this.isActive('dashboard')}><Link onClick={() => this.makeActive('dashboard')} to=\"/\">Dashboard</Link></li>\n            <li className={this.isActive('logs')}><Link onClick={() => this.makeActive('logs')} to=\"/logs\">Logs</Link></li>\n            <li className={this.isActive('tools')}><Link onClick={() => this.makeActive('tools')} to=\"/tools\">Tools</Link></li>\n          </ul>\n        </div>\n        <Switch>\n            <Route exact path=\"/\"\n              render={(props) =>\n                <Dashboard ws={this.state.ws}\n                           airports={this.state.airports}\n                           metars={this.state.metars}\n                           metarCount={this.state.metarCount}\n                           lastUpdated={this.state.lastUpdated}\n                />\n              }>\n            </Route>\n            <Route path=\"/logs\">\n              <Logs logLines={this.state.logLines}/>\n            </Route>\n            <Route path=\"/tools\">\n              <Tools ws={this.state.ws}/>\n            </Route>\n        </Switch>\n      </Router>\n    )\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/index.scss';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}